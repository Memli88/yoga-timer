<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Morning Yoga Timer</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Yoga Timer">

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
  margin: 0;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container { width: 94%; max-width: 460px; text-align: center; }
h1 { font-size: 1.2rem; margin-bottom: 0.3rem; }
.section { color: #93c5fd; font-size: 1rem; margin-top: 0.5rem; }
.movement { font-size: 1.1rem; margin-top: 0.4rem; }
.nextMovement { font-size: 0.9rem; opacity: 0.8; margin-top: 0.2rem; }
.timer { font-size: 3.6rem; margin: 0.6rem 0; }
.instruction {
  font-size: 0.9rem;
  opacity: 0.85;
  line-height: 1.3;
}
button {
  padding: 12px 18px;
  margin: 6px;
  border: none;
  border-radius: 8px;
  background: #2563eb;
  color: white;
}
.controls {
  margin-top: 10px;
  display: flex;
  justify-content: center;
  gap: 12px;
}
.controls button { padding: 10px 14px; font-size: 0.9rem; }
</style>
</head>

<body>
<div class="container">
  <h1>ðŸŒž Morning Full-Body Yoga</h1>

  <div class="section" id="section"></div>
  <div class="movement" id="movement"></div>
  <div class="nextMovement" id="nextMovement"></div>
  <div class="timer" id="timer">00:00</div>
  <div class="instruction" id="instruction"></div>

  <div>
    <button onclick="start()">Start</button>
    <button onclick="pause()">Pause</button>
    <button onclick="reset()">Reset</button>
  </div>

  <div class="controls">
    <button onclick="prev()">â¬… Previous</button>
    <button onclick="next()">Next âž¡</button>
  </div>
</div>

<script>
if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js');

/* ðŸ“± Keep Screen Awake if possible */
let wakeLock = null;
async function lockScreen() {
  try {
    wakeLock = await navigator.wakeLock.request("screen");
  } catch (e) {}
}

/* ðŸ”” Bell */
const bell = new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA=");

/* ðŸ§˜ FULL PRACTICE DATA (your full routine) */
const practice = [...YOUR EXACT ARRAY â€” paste your array here...];

/* Timer Engine */
let s=0, m=0, t=practice[0].steps[0].time, interval;
const sectionEl=document.getElementById("section");
const movementEl=document.getElementById("movement");
const instructionEl=document.getElementById("instruction");
const nextMovementEl=document.getElementById("nextMovement");
const timerEl=document.getElementById("timer");

function getNextText() {
  let ns=s, nm=m+1;
  if (nm>=practice[s].steps.length) { nm=0; ns++; }
  if (ns>=practice.length) return "Next: â€”";
  return "Next: " + practice[ns].steps[nm].name;
}

function render() {
  const step=practice[s].steps[m];
  sectionEl.textContent=practice[s].section;
  movementEl.textContent=step.name;
  instructionEl.textContent=step.cue;
  nextMovementEl.textContent=getNextText();
  timerEl.textContent=
   `${String(Math.floor(t/60)).padStart(2,"0")}:${String(t%60).padStart(2,"0")}`;
}

function advance() {
  m++;
  if (m>=practice[s].steps.length) { m=0; s++; }
  if (s>=practice.length) {
    clearInterval(interval);
    sectionEl.textContent="Practice Complete ðŸŒ¿";
    movementEl.textContent="Sat Nam";
    timerEl.textContent="";
    instructionEl.textContent="";
    nextMovementEl.textContent="";
    return false;
  }
  t=practice[s].steps[m].time;
  return true;
}

function start() {
  lockScreen();
  bell.play().catch(()=>{});
  if (interval) return;
  interval=setInterval(()=>{
    t--;
    if (t<0) {
      bell.play().catch(()=>{});
      if (!advance()) return;
    }
    render();
  },1000);
}

function pause() {
  clearInterval(interval);
  interval=null;
}

function reset() {
  pause();
  s=0; m=0; t=practice[0].steps[0].time;
  render();
}

function next() {
  pause();
  if (!advance()) return;
  render();
}

function prev() {
  pause();
  m--;
  if (m<0) { s--; if (s<0){ s=0; m=0; } else m=practice[s].steps.length-1; }
  t=practice[s].steps[m].time;
  render();
}

render();
</script>
</body>
</html>
